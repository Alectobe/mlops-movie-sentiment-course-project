# **IMDB Sentiment Analysis ‚Äî MLOps Pipeline (FastAPI + Docker + ClearML)**

–ö—É—Ä—Å–æ–≤–æ–π –ø—Ä–æ–µ–∫—Ç –ø–æ –¥–∏—Å—Ü–∏–ø–ª–∏–Ω–µ **¬´–û–ø–µ—Ä–∞—Ü–∏–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—è –º–æ–¥–µ–ª–µ–π –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è¬ª**.

–¶–µ–ª—å —Ä–∞–±–æ—Ç—ã ‚Äî –ø–æ—Å—Ç—Ä–æ–∏—Ç—å –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π MLOps-–ø—Ä–æ—Ü–µ—Å—Å –≤–æ–∫—Ä—É–≥ –∑–∞–¥–∞—á–∏ –∞–Ω–∞–ª–∏–∑–∞ —Ç–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ –æ—Ç–∑—ã–≤–æ–≤ –æ —Ñ–∏–ª—å–º–∞—Ö (Sentiment Analysis):
–æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ ‚Üí —Ç—Ä–µ–∫–∏–Ω–≥ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤ ‚Üí —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤ ‚Üí –∑–∞–ø—É—Å–∫ –∏–Ω—Ñ–µ—Ä–µ–Ω—Å-—Å–µ—Ä–≤–∏—Å–∞ ‚Üí –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è.

---

# üöÄ **1. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞**

```
mlops_movie_sentiment/
‚îÇ
‚îú‚îÄ‚îÄ app/                    # FastAPI —Å–µ—Ä–≤–∏—Å
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îî‚îÄ‚îÄ main.py
‚îÇ
‚îú‚îÄ‚îÄ configs/
‚îÇ   ‚îî‚îÄ‚îÄ config.yaml         # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ train –∏ inference
‚îÇ
‚îú‚îÄ‚îÄ models/                 # –°–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã (–º–æ–¥–µ–ª—å + TF-IDF)
‚îÇ   ‚îú‚îÄ‚îÄ logreg_imdb.joblib
‚îÇ   ‚îî‚îÄ‚îÄ tfidf_imdb.joblib
‚îÇ
‚îú‚îÄ‚îÄ notebooks/
‚îÇ   ‚îî‚îÄ‚îÄ 01_baseline_imdb.ipynb
‚îÇ
‚îú‚îÄ‚îÄ data/
‚îÇ   ‚îî‚îÄ‚îÄ raw/IMDB Dataset.csv
‚îÇ
‚îú‚îÄ‚îÄ Dockerfile
‚îú‚îÄ‚îÄ requirements.txt
‚îú‚îÄ‚îÄ MODEL_CARD.md
‚îú‚îÄ‚îÄ DATASET_CARD.md
‚îî‚îÄ‚îÄ README.md
```

---

# üîß **2. –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –ø—Ä–æ–µ–∫—Ç–∞**

### ‚úî **–ú–æ–¥–µ–ª—å**

* Logistic Regression
* TF-IDF –≤–µ–∫—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
* –ú–µ—Ç—Ä–∏–∫–∞: Accuracy ‚âà **0.87‚Äì0.90** (–≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏)

### ‚úî **–≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã**

–¢—Ä–µ–∫–∏–Ω–≥ —Å –ø–æ–º–æ—â—å—é **ClearML**:

* 3 —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞ —Å —Ä–∞–∑–Ω—ã–º–∏ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
* 2 –≤–µ—Ä—Å–∏–∏ –ø—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–∏–Ω–≥–∞ (unigram + bigram)
* –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ª–æ–≥–∏–Ω–≥: –º–µ—Ç—Ä–∏–∫–∏, –∫–æ–Ω—Ñ–∏–≥, confusion matrix, –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã –º–æ–¥–µ–ª–∏

### ‚úî **–ò–Ω—Ñ–µ—Ä–µ–Ω—Å-—Å–µ—Ä–≤–∏—Å**

FastAPI + Swagger UI
–≠–Ω–¥–ø–æ–∏–Ω—Ç—ã:

* `GET /health` ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
* `POST /predict` ‚Äî –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ —Ç–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ –æ—Ç–∑—ã–≤–∞

### ‚úî **–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è**

* Dockerfile –Ω–∞ `python:3.10-slim`
* –ú–æ–¥–µ–ª—å –∏ –≤–µ–∫—Ç–æ—Ä–∏–∑–∞—Ç–æ—Ä –∫–æ–ø–∏—Ä—É—é—Ç—Å—è –≤ –æ–±—Ä–∞–∑
* –°—Ç–∞—Ä—Ç —Å–µ—Ä–≤–∏—Å–∞ –æ–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π

---

# ‚öôÔ∏è **3. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫ –ª–æ–∫–∞–ª—å–Ω–æ**

## üîπ 3.1 –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
pip install -r requirements.txt
```

## üîπ 3.2 –ó–∞–ø—É—Å–∫ FastAPI —Å–µ—Ä–≤–∏—Å–∞ –ª–æ–∫–∞–ª—å–Ω–æ

```bash
uvicorn app.main:app --reload --host 0.0.0.0 --port 8000
```

–ü—Ä–æ–≤–µ—Ä–∫–∞:

* [http://127.0.0.1:8000/health](http://127.0.0.1:8000/health)
* [http://127.0.0.1:8000/docs](http://127.0.0.1:8000/docs) (Swagger)

---

# üê≥ **4. –ó–∞–ø—É—Å–∫ –≤ Docker**

## üîπ 4.1 –°–±–æ—Ä–∫–∞ –æ–±—Ä–∞–∑–∞

```bash
docker build -t mlops-movie-sentiment .
```

## üîπ 4.2 –ó–∞–ø—É—Å–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞

```bash
docker run --rm -p 8008:8000 mlops-movie-sentiment
```

–ü—Ä–æ–≤–µ—Ä–∫–∞:

```bash
curl http://127.0.0.1:8008/health
```

–ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ:

```bash
curl -X POST "http://127.0.0.1:8008/predict" \
  -H "Content-Type: application/json" \
  -d '{"review": "Amazing movie! Loved every moment."}'
```

---

# üìä **5. –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã –≤ ClearML**

–í –ø—Ä–æ–µ–∫—Ç–µ –ø—Ä–æ–≤–µ–¥–µ–Ω—ã 3 —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞:

| –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç              | max_features | ngram_range | preprocessing_version |
| ------------------------ | ------------ | ----------- | --------------------- |
| logreg_tfidf_v1          | 5000         | (1,2)       | tfidf_v1              |
| logreg_tfidf_v2_max10000 | 10000        | (1,2)       | tfidf_v2              |
| logreg_tfidf_unigram     | 5000         | (1,1)       | unigram_v1            |

–õ–æ–≥–∏—Ä—É–µ—Ç—Å—è:

* accuracy
* classification_report
* confusion matrix
* –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã –º–æ–¥–µ–ª–∏
* –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–°–∫—Ä–∏–Ω—à–æ—Ç—ã ClearML –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –≤ –æ—Ç—á—ë—Ç.

---

# üß© **6. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞ (config.yaml)**

–ü—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –µ–¥–∏–Ω—ã–π YAML-—Ñ–∞–π–ª:

```yaml
train:
  random_state: 42
  test_size: 0.2

  vectorizer:
    max_features: 5000
    ngram_range: [1, 2]
    stop_words: "english"

  model:
    type: "LogisticRegression"
    max_iter: 1000
    n_jobs: -1

  data:
    path: "data/raw/IMDB Dataset.csv"
    source: "Kaggle"

inference:
  model_path: "models/logreg_imdb.joblib"
  vectorizer_path: "models/tfidf_imdb.joblib"
```

FastAPI –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **inference** —Å–µ–∫—Ü–∏—é.

---

# üìÑ **7. Model Card & Dataset Card**

* **MODEL_CARD.md** ‚Äî –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞, –º–µ—Ç—Ä–∏–∫–∏, –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è
* **DATASET_CARD.md** ‚Äî –ø—Ä–æ–∏—Å—Ö–æ–∂–¥–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö, –ª–∏—Ü–µ–Ω–∑–∏—è, –æ–ø–∏—Å–∞–Ω–∏–µ —Å–ø–ª–∏—Ç–æ–≤

–û–±–∞ —Ñ–∞–π–ª–∞ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞.

---

# üß™ **8. –ë—ã—Å—Ç—Ä—ã–π –ø—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è API**

```bash
POST /predict
{
  "review": "The movie was terrible, boring and slow."
}

–†–µ–∑—É–ª—å—Ç–∞—Ç:
{
  "sentiment": "negative",
  "positive_proba": 0.03,
  "negative_proba": 0.97
}
```

---

# üèÅ **9. –ò—Ç–æ–≥–∏**

–ü—Ä–æ–µ–∫—Ç –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –ø–æ–ª–Ω—ã–π —Ü–∏–∫–ª MLOps –≤–æ–∫—Ä—É–≥ NLP-–º–æ–¥–µ–ª–∏:

* –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö
* –æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏
* —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã –≤ ClearML
* —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤
* –∏–Ω—Ñ–µ—Ä–µ–Ω—Å-—Å–µ—Ä–≤–∏—Å –Ω–∞ FastAPI
* –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ Docker
* –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ YAML

# **10. –ü–∞–π–ø–ª–∞–π–Ω**

## 2.1. –°—Ö–µ–º–∞ –ø–∞–π–ø–ª–∞–π–Ω–∞

```mermaid
flowchart LR
    A[IMDB Dataset.csv<br/>data/raw] --> B[–ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏ –æ–±—É—á–µ–Ω–∏–µ<br/>01_baseline_imdb.ipynb]
    B --> C[–≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã –≤ ClearML<br/>logreg_tfidf_v1 / v2 / unigram]
    B --> D[–ê—Ä—Ç–µ—Ñ–∞–∫—Ç—ã –º–æ–¥–µ–ª–∏<br/>logreg_imdb.joblib<br/>tfidf_imdb.joblib]
    D --> E[–ò–Ω—Ñ–µ—Ä–µ–Ω—Å-—Å–µ—Ä–≤–∏—Å FastAPI<br/>app/main.py]
    E --> F[Docker-–æ–±—Ä–∞–∑<br/>mlops-movie-sentiment]
    F --> G[–ö–ª–∏–µ–Ω—Ç<br/>curl /predict –∏–ª–∏ Swagger UI]
```
